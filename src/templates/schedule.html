<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        body { background-color: #f8f9fa; }

        /* –ñ–µ—Å—Ç–∫–∞—è —Å–µ—Ç–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è */
        .calendar-table {
            table-layout: fixed;
            width: 100%;
            background: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .calendar-table th {
            background-color: #2c3e50;
            color: white;
            text-align: center;
            padding: 10px;
        }

        .calendar-table td {
            height: 100px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ —è—á–µ–π–∫–∏ */
            vertical-align: top;
            padding: 5px;
            border: 1px solid #dee2e6;
            width: 19%; /* 5 –¥–Ω–µ–π = ~20% */
        }

        .period-col {
            width: 50px !important;
            background-color: #e9ecef;
            text-align: center;
            vertical-align: middle !important;
            font-weight: bold;
            color: #495057;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ —É—Ä–æ–∫–∞ –≤–Ω—É—Ç—Ä–∏ —è—á–µ–π–∫–∏ */
        .lesson-card {
            background: #fff;
            border-left: 5px solid #0d6efd; /* –°–∏–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            padding: 5px 8px;
            margin-bottom: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            border-radius: 4px;
            font-size: 0.85rem;
            transition: transform 0.1s;
        }
        .lesson-card:hover { transform: scale(1.02); }

        /* –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ */
        .subgroup-1 { border-left-color: #ffc107; background-color: #fffbf0; } /* –ñ–µ–ª—Ç—ã–π */
        .subgroup-2 { border-left-color: #fd7e14; background-color: #fff5f0; } /* –û—Ä–∞–Ω–∂–µ–≤—ã–π */
        .gym { border-left-color: #198754; } /* –ó–µ–ª–µ–Ω—ã–π */

        .subject { font-weight: 700; color: #212529; }
        .meta { display: flex; justify-content: space-between; margin-top: 4px; color: #6c757d; font-size: 0.75rem; }
        .room-badge { background: #e9ecef; padding: 1px 5px; border-radius: 4px; font-weight: bold; color: #495057; }

        /* –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Å–º–µ–Ω */
        .shift-divider { border-top: 4px solid #adb5bd !important; }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">üìÖ –õ–∏—Ü–µ–π</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="mainNav">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link active" href="/">–û–±—â–∏–π –≤–∏–¥</a></li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">–£—á–∏—Ç–µ–ª—è</a>
          <ul class="dropdown-menu scrollable-menu" style="max-height: 400px; overflow-y: auto;">
            {% for t in all_teachers %}
            <li><a class="dropdown-item" href="/teacher/{{ t.id }}">{{ t.name }}</a></li>
            {% endfor %}
          </ul>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">–ö–ª–∞—Å—Å—ã</a>
          <ul class="dropdown-menu" style="max-height: 400px; overflow-y: auto;">
            {% for g in all_groups %}
            <li><a class="dropdown-item" href="/group/{{ g.id }}">{{ g.name }}</a></li>
            {% endfor %}
          </ul>
        </li>
      </ul>

      <div class="d-flex">
          <form action="/generate" method="post" class="me-2">
             <button class="btn btn-success btn-sm" type="submit">‚ö° –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å</button>
          </form>
          <a href="/admin" class="btn btn-outline-light btn-sm">–ê–¥–º–∏–Ω–∫–∞</a>
      </div>
    </div>
  </div>
</nav>

<div class="container-fluid mt-4">
    <h3 class="mb-3 text-center text-secondary">{{ title }}</h3>

    <div class="table-responsive">
        <table class="table calendar-table">
            <thead>
                <tr>
                    <th class="period-col">#</th>
                    <th>–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</th>
                    <th>–í—Ç–æ—Ä–Ω–∏–∫</th>
                    <th>–°—Ä–µ–¥–∞</th>
                    <th>–ß–µ—Ç–≤–µ—Ä–≥</th>
                    <th>–ü—è—Ç–Ω–∏—Ü–∞</th>
                </tr>
            </thead>
            <tbody>
                {% for period in range(1, 14) %}
                <tr class="{% if period == 8 %}shift-divider{% endif %}">
                    <td class="period-col">{{ period }}</td>

                    {% for day in range(1, 6) %}
                    <td>
                        {% set lessons = schedule_grid.get((day, period), []) %}

                        {% for lesson in lessons %}
                        <div class="lesson-card
                            {% if '–ì—Ä. 1' in lesson.subject %}subgroup-1
                            {% elif '–ì—Ä. 2' in lesson.subject %}subgroup-2
                            {% elif '–°–ø–æ—Ä—Ç–∑–∞–ª' in lesson.room %}gym{% endif %}">

                            <div class="subject">{{ lesson.subject }}</div>

                            <div class="meta">
                                <span>
                                    {% if show_teacher_name %}
                                        üë®‚Äçüè´ {{ lesson.teacher }}
                                    {% endif %}
                                    {% if show_group_name %}
                                        üéì {{ lesson.group }}
                                    {% endif %}
                                </span>
                                <span class="room-badge">{{ lesson.room }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

</body>
</html>