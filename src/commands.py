import click
import random
from flask.cli import with_appcontext
from src.extensions import db
from src.models.school import School, Room, Teacher, Subject
from src.models.schedule import StudentGroup, TimeSlot, Workload
from src.models.enums import RoomType, SubgroupType


@click.command('seed_db')
@with_appcontext
def seed_db_command():
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –°–æ—Ñ–∏–µ–≤—Å–∫–æ-–ë–æ—Ä—â–∞–≥–æ–≤—Å–∫–æ–≥–æ –ª–∏—Ü–µ—è."""

    print("üßπ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–π –±–∞–∑—ã...")
    db.drop_all()
    db.create_all()

    # 1. –®–ö–û–õ–ê
    school = School(name='–°–æ—Ñ—ñ—ó–≤—Å—å–∫–æ-–ë–æ—Ä—â–∞–≥—ñ–≤—Å—å–∫–∏–π –ª—ñ—Ü–µ–π')
    db.session.add(school)
    db.session.flush()  # –ü–æ–ª—É—á–∞–µ–º ID

    # 2. –ö–ê–ë–ò–ù–ï–¢–´ (–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –Ω–∞–±–æ—Ä)
    print("üèó –°—Ç—Ä–æ–∏–º –∫–∞–±–∏–Ω–µ—Ç—ã...")
    rooms = []
    # –û–±—ã—á–Ω—ã–µ –∫–ª–∞—Å—Å—ã
    for i in range(101, 115): rooms.append(Room(name=f"{i}", school_id=school.id))
    for i in range(201, 215): rooms.append(Room(name=f"{i}", school_id=school.id))
    # –°–ø–µ—Ü. –∫–∞–±–∏–Ω–µ—Ç—ã
    rooms.extend([
        Room(name="–°–ø–æ—Ä—Ç–∑–∞–ª 1 (–í–µ–ª–∏–∫–∏–π)", room_type=RoomType.GYM, capacity=60, school_id=school.id),
        Room(name="–°–ø–æ—Ä—Ç–∑–∞–ª 2 (–ú–∞–ª–∏–π)", room_type=RoomType.GYM, capacity=30, school_id=school.id),
        Room(name="205 (–•—ñ–º—ñ—è)", room_type=RoomType.LAB_CHEMISTRY, school_id=school.id),
        Room(name="206 (–§—ñ–∑–∏–∫–∞)", room_type=RoomType.LAB_PHYSICS, school_id=school.id),
        Room(name="207 (–ë—ñ–æ–ª–æ–≥—ñ—è)", room_type=RoomType.LAB_BIO, school_id=school.id),
        Room(name="301 (–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞)", room_type=RoomType.IT_LAB, capacity=15, school_id=school.id),
        Room(name="302 (–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞)", room_type=RoomType.IT_LAB, capacity=15, school_id=school.id),
        Room(name="–ê–∫—Ç–æ–≤–∞ –∑–∞–ª–∞", school_id=school.id),
        Room(name="–ú–∞–π—Å—Ç–µ—Ä–Ω—è", school_id=school.id)
    ])
    db.session.add_all(rooms)
    db.session.flush()

    # 3. –£–ß–ò–¢–ï–õ–Ø (–ò–∑ —Ç–≤–æ–µ–≥–æ PDF)
    print("üë®‚Äçüè´ –ù–∞–Ω–∏–º–∞–µ–º —É—á–∏—Ç–µ–ª–µ–π...")
    # –°–ª–æ–≤–∞—Ä—å: –§–ò–û -> –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–µ–¥–º–µ—Ç (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏)
    teachers_map = {
        "–ê–º—à–∞—Ä—é–∫ –¢–µ—Ç—è–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–ê–Ω–¥—Ä—É—â–µ–Ω–∫–æ –õ–∞—Ä–∏—Å–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–í–µ—Ä–±—ñ—Ü—å–∫–∞ –û–∫—Å–∞–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–í–æ—Ä–æ–±–π–æ–≤ –Ñ–≥–æ—Ä": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–ì–ª—É—Ö–æ–≤–∞ –ù–∞—Ç–∞–ª—ñ—è": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ñ–Ω–æ–≤–∞ –õ—é–±–æ–≤": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–ù–∞–∑–∞—Ä—á—É–∫ –¢–µ—Ç—è–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–ü–µ—á–µ–Ω—é–∫ –ó–æ—Ä—è–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–¢–µ—Ç–µ—Ä—á—É–∫ –û–ª–µ–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–ë–∞–Ω–¥—É—Ä–∞ –¢–µ—Ç—è–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–°—Ç–µ–ø–∞–Ω–æ–≤–∏—á –ö–∞—Ç–µ—Ä–∏–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–ö—É—á–µ—Ä –¢–µ—Ç—è–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–û–≥–∏—Ä–µ–Ω–∫–æ –ù–∞—Ç–∞–ª—ñ—è": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–¢–∫–∞—á–µ–Ω–∫–æ –û–ª–µ–∫—Å–∞–Ω–¥—Ä": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–õ—É—Ü–µ–Ω–∫–æ –ù–∞—Ç–∞–ª—ñ—è": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–¢—î—Ä—î—Ö–æ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–°–∏–¥–æ—Ä–µ–Ω–∫–æ –ö–∞—Ç–µ—Ä–∏–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–ë–æ–≤–∫—É–Ω –ù–∞—Ç–∞–ª—ñ—è": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–û–ª–µ–Ω—Å—å–∫–∞ –ê–ª—å–æ–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–ê–Ω—Ç–æ–Ω—é–∫ –Æ–ª—ñ—è": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–î–µ–Ω–∏—Å–µ–Ω–∫–æ –¢–∞–º–∞—Ä–∞": "–§—Ä–∞–Ω—Ü. –º–æ–≤–∞",  # –í–µ–¥–µ—Ç –∏ –∞–Ω–≥–ª, –Ω–æ –¥–∞–¥–∏–º –≤—Ç–æ—Ä–æ–π —è–∑—ã–∫
        "–Ü—â–µ–Ω–∫–æ –ê–Ω–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–°–µ—Ä–±—ñ–Ω –õ—ñ–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–°–æ–ª–æ–≤–π–æ–≤–∞ –ö–∞—Ç–µ—Ä–∏–Ω–∞": "–ê–Ω–≥–ª. –º–æ–≤–∞",
        "–°–∞–≤—ñ—Ü—å–∫–∞ –ú–∞—Ä—Ç–∞": "–ù—ñ–º. –º–æ–≤–∞",
        "–î–∑–µ—Ü—ñ–Ω–∞ –°–≤—ñ—Ç–ª–∞–Ω–∞": "–ù—ñ–º. –º–æ–≤–∞",
        "–û–ª—ñ–π–Ω–∏–∫ –ù–∞—Ç–∞–ª—ñ—è": "–ù—ñ–º. –º–æ–≤–∞",
        "–ë–æ–Ω–¥–∞—Ä–µ–Ω–∫–æ –ì–∞–ª–∏–Ω–∞": "–£–∫—Ä. –º–æ–≤–∞",
        "–ì–æ—Ä–±—É–Ω–æ–≤–∞ –ì–∞–ª–∏–Ω–∞": "–£–∫—Ä. –º–æ–≤–∞",
        "–ö–∞–º–±—É—Ä –û–∫—Å–∞–Ω–∞": "–£–∫—Ä. –º–æ–≤–∞",
        "–ö—É—á–º—ñ–π –°–≤—ñ—Ç–ª–∞–Ω–∞": "–£–∫—Ä. –º–æ–≤–∞",
        "–õ—É—Ç—é–∫ –ö–∞—Ç–µ—Ä–∏–Ω–∞": "–£–∫—Ä. –º–æ–≤–∞",
        "–ú–∞–º–∑—ñ–Ω–∞ –û–ª–µ–Ω–∞": "–£–∫—Ä. –º–æ–≤–∞",
        "–ú–∞—Ü–∫–µ–≤–∏—á –û–ª–µ–Ω–∞": "–£–∫—Ä. –ª—ñ—Ç.",
        "–•–∞—Ä–µ–Ω–∫–æ –ù—ñ–Ω–∞": "–£–∫—Ä. –º–æ–≤–∞",
        "–®–µ–≤—á—É–∫ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞": "–£–∫—Ä. –º–æ–≤–∞",
        "–ö–ª–æ–ø–æ—Ç –Ñ–≤–≥–µ–Ω—ñ—è": "–£–∫—Ä. –º–æ–≤–∞",
        "–ë–ª–∞–∂–µ—î–≤–∞ –Æ–ª—ñ—è": "–£–∫—Ä. –º–æ–≤–∞",
        "–ö–∞–ª–µ–Ω—é–∫ –ù–∞—Ç–∞–ª—ñ—è": "–£–∫—Ä. –º–æ–≤–∞",
        "–ú—É–∑–∏–ª–µ–Ω–∫–æ –û–∫—Å–∞–Ω–∞": "–£–∫—Ä. –º–æ–≤–∞",
        "–ö–æ–ª–æ–±'—é–∫ –ú–∞—Ä–∏–Ω–∞": "–£–∫—Ä. –º–æ–≤–∞",
        "–õ–æ–ø–∞—Ç–∫—ñ–Ω–∞ –û–∫—Å–∞–Ω–∞": "–£–∫—Ä. –ª—ñ—Ç.",
        "–ü–µ—Ç—Ä–µ–Ω–∫–æ –Ü–Ω–Ω–∞": "–ó–∞—Ä. –ª—ñ—Ç.",
        "–ö–æ–º–∞—Ä–æ–≤–∞ –ì–∞–ª–∏–Ω–∞": "–ó–∞—Ä. –ª—ñ—Ç.",
        "–ö—É–ª—ñ—à –í—ñ–∫—Ç–æ—Ä—ñ—è": "–î—Ä–∞–º. —ñ —Ç–µ–∞—Ç—Ä",
        "–î—Ä–µ–ª–∏–Ω—Å—å–∫–∞ –û–ª–µ–Ω–∞": "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞",
        "–¢–∏—â–µ–Ω–∫–æ –ù–∞—Ç–∞–ª—ñ—è": "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"
        # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –¥–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å
    }

    db_teachers = {}
    for name in teachers_map.keys():
        t = Teacher(name=name, school_id=school.id)
        db.session.add(t)
        db_teachers[name] = t

    # –î–æ–±–∞–≤–∏–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª–æ–≤ –¥–ª—è —Ñ–∏–∑—Ä—ã –∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ
    extra_teachers = ["–ì–æ–Ω—á–∞—Ä –í–∞—Å–∏–ª—å", "–ö–æ–≤–∞–ª—å –Ü–≥–æ—Ä", "–®–µ–≤—á–µ–Ω–∫–æ –Ü—Ä–∏–Ω–∞", "–ë–æ–π–∫–æ –û–ª–µ–≥"]
    for name in extra_teachers:
        t = Teacher(name=name, school_id=school.id)
        db.session.add(t)
        db_teachers[name] = t

    db.session.flush()

    # 4. –ü–†–ï–î–ú–ï–¢–´
    print("üìö –£—Ç–≤–µ—Ä–∂–¥–∞–µ–º —É—á–µ–±–Ω—ã–π –ø–ª–∞–Ω...")
    subjects_list = [
        "–ê–Ω–≥–ª. –º–æ–≤–∞", "–ù—ñ–º. –º–æ–≤–∞", "–§—Ä–∞–Ω—Ü. –º–æ–≤–∞", "–ü–æ–ª. –º–æ–≤–∞",
        "–£–∫—Ä. –º–æ–≤–∞", "–£–∫—Ä. –ª—ñ—Ç.", "–ó–∞—Ä. –ª—ñ—Ç.",
        "–Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏", "–í—Å–µ—Å–≤—ñ—Ç–Ω—è —ñ—Å—Ç–æ—Ä—ñ—è", "–ü—Ä–∞–≤–æ–∑–Ω–∞–≤—Å—Ç–≤–æ",
        "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "–ê–ª–≥–µ–±—Ä–∞", "–ì–µ–æ–º–µ—Ç—Ä—ñ—è",
        "–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", "–§—ñ–∑–∏–∫–∞", "–ê—Å—Ç—Ä–æ–Ω–æ–º—ñ—è", "–•—ñ–º—ñ—è", "–ë—ñ–æ–ª–æ–≥—ñ—è",
        "–ì–µ–æ–≥—Ä–∞—Ñ—ñ—è", "–ü—Ä–∏—Ä–æ–¥–æ–∑–Ω–∞–≤—Å—Ç–≤–æ", "–Ø –¥–æ—Å–ª—ñ–¥–∂—É—é —Å–≤—ñ—Ç",
        "–û—Å–Ω–æ–≤–∏ –∑–¥–æ—Ä–æ–≤'—è", "–§—ñ–∑–∏—á–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞",
        "–ú–∏—Å—Ç–µ—Ü—Ç–≤–æ", "–ú—É–∑–∏—á–Ω–µ –º–∏—Å—Ç–µ—Ü—Ç–≤–æ", "–û–±—Ä–∞–∑–æ—Ç–≤–æ—Ä—á–µ –º–∏—Å—Ç–µ—Ü—Ç–≤–æ",
        "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó", "–ó–∞—Ö–∏—Å—Ç –£–∫—Ä–∞—ó–Ω–∏", "–ì—Ä–æ–º–∞–¥—è–Ω—Å—å–∫–∞ –æ—Å–≤—ñ—Ç–∞",
        "–î—Ä–∞–º. —ñ —Ç–µ–∞—Ç—Ä", "–•–æ—Ä–µ–æ–≥—Ä–∞—Ñ—ñ—è", "STEM"
    ]
    db_subjects = {}
    for s_name in subjects_list:
        s = Subject(name=s_name, school_id=school.id)
        db.session.add(s)
        db_subjects[s_name] = s
    db.session.flush()

    # 5. –ö–õ–ê–°–°–´ (–° 1 –ø–æ 11, –ø–∞—Ä–∞–ª–ª–µ–ª–∏ –ê, –ë, –í, –ì)
    print("üéì –§–æ—Ä–º–∏—Ä—É–µ–º –∫–ª–∞—Å—Å—ã...")
    classes = []
    letters = ['–ê', '–ë', '–í', '–ì']
    db_groups = []

    # –ú–ª–∞–¥—à–∞—è —à–∫–æ–ª–∞ (1-4) - 1 —Å–º–µ–Ω–∞
    for grade in range(1, 5):
        for let in letters:
            g = StudentGroup(name=f"{grade}-{let}", size=30, shift=1, school_id=school.id)
            db.session.add(g)
            db_groups.append(g)

    # –°—Ä–µ–¥–Ω—è—è —à–∫–æ–ª–∞ (5-8) - —Å–º–µ—à–∞–Ω–Ω—ã–µ —Å–º–µ–Ω—ã (–ø—É—Å—Ç—å 5,6 - 1 —Å–º–µ–Ω–∞, 7,8 - 2 —Å–º–µ–Ω–∞ –¥–ª—è –∏–Ω—Ç–µ—Ä–µ—Å–∞)
    for grade in range(5, 9):
        shift = 1 if grade < 7 else 2
        for let in letters:
            g = StudentGroup(name=f"{grade}-{let}", size=30, shift=shift, school_id=school.id)
            db.session.add(g)
            db_groups.append(g)

    # –°—Ç–∞—Ä—à–∞—è —à–∫–æ–ª–∞ (9-11) - 1 —Å–º–µ–Ω–∞
    for grade in range(9, 12):
        for let in letters[:3]:  # –ú–µ–Ω—å—à–µ –∫–ª–∞—Å—Å–æ–≤
            g = StudentGroup(name=f"{grade}-{let}", size=25, shift=1, school_id=school.id)
            db.session.add(g)
            db_groups.append(g)

    db.session.flush()

    # 6. –°–õ–û–¢–´ –í–†–ï–ú–ï–ù–ò (13 —É—Ä–æ–∫–æ–≤)
    print("‚è∞ –ó–∞–≤–æ–¥–∏–º –±—É–¥–∏–ª—å–Ω–∏–∫–∏...")
    for day in range(1, 6):
        for i in range(1, 14):  # 13 —É—Ä–æ–∫–æ–≤
            # –°–º–µ–Ω–∞ 1: —É—Ä–æ–∫–∏ 1-7 (–∏–ª–∏ 1-8)
            # –°–º–µ–Ω–∞ 2: —É—Ä–æ–∫–∏ 6-13
            # –ú—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ—á–∞–µ–º –∏—Ö, –ª–æ–≥–∏–∫–∞ –≤ Solver
            shift_num = 1 if i <= 7 else 2
            # –°–ª–æ—Ç "–ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–π" (6,7,8 —É—Ä–æ–∫) –ø–æ–¥—Ö–æ–¥–∏—Ç –≤—Å–µ–º, –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
            db.session.add(TimeSlot(day_of_week=day, period_number=i, shift_number=shift_num, school_id=school.id))

    db.session.flush()

    # 7. –ì–ï–ù–ï–†–ê–¶–ò–Ø –ù–ê–ì–†–£–ó–ö–ò (–°–∞–º–æ–µ —Å–ª–æ–∂–Ω–æ–µ)
    print("üíº –†–∞–∑–¥–∞–µ–º –Ω–∞–≥—Ä—É–∑–∫—É (—ç—Ç–æ –∑–∞–π–º–µ—Ç –≤—Ä–µ–º—è)...")

    workloads = []

    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —É—á–∏—Ç–µ–ª—è –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É
    def get_teacher_for_subject(subj_name):
        # 1. –ò—â–µ–º –ø—Ä–æ—Ñ–∏–ª—å–Ω–æ–≥–æ
        candidates = [t for name, main_subj in teachers_map.items() if main_subj == subj_name and name in db_teachers]
        if candidates: return db_teachers[random.choice(candidates).name]
        # 2. –ï—Å–ª–∏ –Ω–µ—Ç, –±–µ—Ä–µ–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª–∞
        return db_teachers[random.choice(extra_teachers)]

    for group in db_groups:
        grade = int(group.name.split('-')[0])

        # –ü–ª–∞–Ω –æ–±—É—á–µ–Ω–∏—è (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π, –Ω–æ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π)
        curriculum = {}

        if grade <= 4:  # –ù–∞—á–∞–ª—å–Ω–∞—è —à–∫–æ–ª–∞
            curriculum = {
                "–£–∫—Ä. –º–æ–≤–∞": 4, "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞": 4, "–ê–Ω–≥–ª. –º–æ–≤–∞": 3,
                "–Ø –¥–æ—Å–ª—ñ–¥–∂—É—é —Å–≤—ñ—Ç": 2, "–§—ñ–∑–∏—á–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞": 3, "–ú–∏—Å—Ç–µ—Ü—Ç–≤–æ": 2, "–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞": 1
            }
        elif grade <= 9:  # –°—Ä–µ–¥–Ω—è—è
            curriculum = {
                "–£–∫—Ä. –º–æ–≤–∞": 3, "–£–∫—Ä. –ª—ñ—Ç.": 2, "–ê–Ω–≥–ª. –º–æ–≤–∞": 3, "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞": 4,
                "–Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏": 2, "–§—ñ–∑–∏—á–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞": 3, "–ì–µ–æ–≥—Ä–∞—Ñ—ñ—è": 2, "–ë—ñ–æ–ª–æ–≥—ñ—è": 2,
                "–§—ñ–∑–∏–∫–∞": 2, "–•—ñ–º—ñ—è": 2, "–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞": 2, "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó": 1
            }
        else:  # –°—Ç–∞—Ä—à–∞—è
            curriculum = {
                "–£–∫—Ä. –º–æ–≤–∞": 2, "–£–∫—Ä. –ª—ñ—Ç.": 2, "–ê–Ω–≥–ª. –º–æ–≤–∞": 3, "–ê–ª–≥–µ–±—Ä–∞": 3, "–ì–µ–æ–º–µ—Ç—Ä—ñ—è": 2,
                "–Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏": 2, "–í—Å–µ—Å–≤—ñ—Ç–Ω—è —ñ—Å—Ç–æ—Ä—ñ—è": 1, "–§—ñ–∑–∏—á–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞": 2,
                "–§—ñ–∑–∏–∫–∞": 3, "–•—ñ–º—ñ—è": 2, "–ë—ñ–æ–ª–æ–≥—ñ—è": 2, "–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞": 2, "–ó–∞—Ö–∏—Å—Ç –£–∫—Ä–∞—ó–Ω–∏": 2
            }

        for subj_name, hours in curriculum.items():
            if subj_name not in db_subjects: continue  # –ü—Ä–æ–ø—É—Å–∫ –µ—Å–ª–∏ –æ–ø–µ—á–∞—Ç–∫–∞

            subject = db_subjects[subj_name]
            teacher = get_teacher_for_subject(subj_name)

            # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ø–µ—Ü. –∫–∞–±–∏–Ω–µ—Ç–∞
            req_room = RoomType.STANDARD
            if "–§—ñ–∑–∏—á–Ω–∞" in subj_name:
                req_room = RoomType.GYM
            elif "–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞" in subj_name:
                req_room = RoomType.IT_LAB
            elif "–•—ñ–º—ñ—è" in subj_name:
                req_room = RoomType.LAB_CHEMISTRY
            elif "–§—ñ–∑–∏–∫–∞" in subj_name:
                req_room = RoomType.LAB_PHYSICS
            elif "–ë—ñ–æ–ª–æ–≥—ñ—è" in subj_name:
                req_room = RoomType.LAB_BIO

            # –î–ï–õ–ï–ù–ò–ï –ù–ê –ì–†–£–ü–ü–´ (–ê–Ω–≥–ª, –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞, –§–∏–∑—Ä–∞ - –∏–Ω–æ–≥–¥–∞)
            if subj_name in ["–ê–Ω–≥–ª. –º–æ–≤–∞", "–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", "–ù—ñ–º. –º–æ–≤–∞"] and grade > 4:
                # –ì—Ä—É–ø–ø–∞ 1
                t1 = teacher
                w1 = Workload(
                    school_id=school.id, teacher_id=t1.id, subject_id=subject.id, group_id=group.id,
                    hours_per_week=hours, subgroup=SubgroupType.GROUP_1, required_room_type=req_room
                )
                # –ì—Ä—É–ø–ø–∞ 2 (–±–µ—Ä–µ–º –¥—Ä—É–≥–æ–≥–æ —É—á–∏—Ç–µ–ª—è, –µ—Å–ª–∏ –µ—Å—Ç—å)
                t2 = get_teacher_for_subject(subj_name)
                # –ï—Å–ª–∏ —É—á–∏—Ç–µ–ª–µ–π –º–∞–ª–æ, –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ—Ç –∂–µ, –Ω–æ –≤ –∏–¥–µ–∞–ª–µ –¥—Ä—É–≥–æ–π
                if t2.id == t1.id and len(teachers_map) > 10:
                    # –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ –¥—Ä—É–≥–æ–≥–æ
                    pass

                w2 = Workload(
                    school_id=school.id, teacher_id=t2.id, subject_id=subject.id, group_id=group.id,
                    hours_per_week=hours, subgroup=SubgroupType.GROUP_2, required_room_type=req_room
                )
                workloads.extend([w1, w2])
            else:
                # –í–µ—Å—å –∫–ª–∞—Å—Å
                w = Workload(
                    school_id=school.id, teacher_id=teacher.id, subject_id=subject.id, group_id=group.id,
                    hours_per_week=hours, subgroup=SubgroupType.WHOLE_CLASS, required_room_type=req_room
                )
                workloads.append(w)

    print(f"üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º {len(workloads)} –∑–∞–ø–∏—Å–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏...")
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–∞—á–∫–∞–º–∏, —á—Ç–æ–±—ã –Ω–µ –∑–∞–≤–∏—Å–ª–æ
    batch_size = 100
    for i in range(0, len(workloads), batch_size):
        db.session.add_all(workloads[i:i + batch_size])
        db.session.commit()  # –ö–æ–º–º–∏—Ç–∏–º –ø–æ —á–∞—Å—Ç—è–º

    print("‚úÖ –£–°–ü–ï–®–ù–û! –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ª–∏—Ü–µ—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã.")


def register_commands(app):
    app.cli.add_command(seed_db_command)